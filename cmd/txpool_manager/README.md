# txpool_manager - tool for managing txpool

In the root of `Erigon` project, use this command to build the commands:

```shell
    make txpool_manager
```

It can then be run using the following command

```shell
    ./buid/bin/txpool_manager sub-command options...
```

Snapshots supports the following sub commands:

## data-dir

Examples on how to setup your data-dir

```shell
    # on sequencer:
    /erigon-data/data/txpool
```

## list - list the table data in current txpool data-dir

```shell
    txpool_manager list --datadir=<data-dir> --chainID=<number_integer> --outputDir=<output-dir> --listCount=<number_integer>[optional] --table=<table-name>[optional]
```
+ The `chainID` is the chainID of blockchain 
+ The `outputDir` is the output file that query the data from the txpool
+ The `table` is `RecentLocalTransaction` or `PoolTransaction`, default is `PoolTransaction`
+ The `listCount`: default is list all data.

## operating example:
```shell
  ./txpool_manager list --datadir=./erigon-data/data/txpool --chainID=1001 --outputDir=./outputdir
  ./txpool_manager list --datadir=./erigon-data/data/txpool --chainID=1001 --outputDir=./outputdir --listCount=2

  ./txpool_manager list --datadir=./erigon-data/data/txpool --chainID=1001 --outputDir=./outputdir --table=RecentLocalTransaction
  ./txpool_manager list --datadir=./erigon-data/data/txpool --chainID=1001 --outputDir=./outputdir --listCount=2 --table=RecentLocalTransaction
```

## add - add the data to the txpool data-dir
```shell
    txpool_manager add --datadir=<data-dir> --inputFile=<input-data-file-name> --table=<table-name>[optional]
```
+ The `inputFile` is will add keys and values in file that is generated by the `list` command, the file format is need adaptive to the table;
+ The `table` is `RecentLocalTransaction` or `PoolTransaction`, default is `PoolTransaction`

## operating example:
```shell
  ./txpool_manager add --datadir=./erigon-data/data/txpool --inputFile=./outputdir/PoolTransaction-tx-1748501779.json
  ./txpool_manager add --datadir=./erigon-data/data/txpool --inputFile=./outputdir/RecentLocalTransaction-tx-1748933653.json --table=RecentLocalTransaction
```

## delete - delete the data in the txpool data-dir
```shell
    txpool_manager delete --datadir=<data-dir> --delTxKeys="[key1,key2]"[optional] --inputFile=<input-data-file-name>[optional] --table=<table-name>[optional] --all=<bool>[optional] 
```
+ The `delTxKeys` is will delete keys, the keys format is need adaptive to the table
+ The `inputFile` is will delete keys in file that is generated by the `list` command, the file format is need adaptive to the table; 
+ The `table` is `RecentLocalTransaction` or `PoolTransaction`, default is `PoolTransaction`
+ The `all` can set true or false, default is false, set it true will delete all of data in its table
+ The `delTxKeys` and `inputFile` should only be set one

## operating example:
```shell
./txpool_manager delete --datadir=./erigon-data/data/txpool --delTxKeys="[0x0f94cba5054b22f56af1d456faa35ed481d44dff5a741f1522838d0ee45f1c9c,0x2edd0e406600e585ffbe03ffff30f1db6e2e81dd357d5a97d8d6132446ba65bd]"
./txpool_manager delete --datadir=./erigon-data/data/txpool --inputFile=outputdir/PoolTransaction-tx-1748936660.json
./txpool_manager delete --datadir=./erigon-data/data/txpool --all=true

./txpool_manager delete --datadir=./erigon-data/data/txpool --delTxKeys="[0x0000000000000002,0x0000000000000003]" --table=RecentLocalTransaction
./txpool_manager delete --datadir=./erigon-data/data/txpool --inputFile=outputdir/RecentLocalTransaction-tx-1748936653.json --table=RecentLocalTransaction
./txpool_manager delete --datadir=./erigon-data/data/txpool --all=true --table=RecentLocalTransaction
```


